---
title: "Biometry module 6"
output: 
  html_notebook: 
    toc: yes
---

# Introduction

Travail en groupe par rapport à l'étude de la biométrie d'une population de Belgique. Les données ont été récolté par chaque membre de la classe sur des individus. Il y a différentes variable qui ont été mis dans notre tableau de données dans le but d'evaluer leur impact sur la valeur de l'IMC des individus.

L' IMC   ou indice de masse corporelle est une facon de mesurer la corpulence d'une personne.
Cette mesure à été inventée par Adolphe Quetelet ( un belge ) et se calcule comme valant le carré de la taille ( en mètre ) divisée par le masse ( en kg ).

# But

Notre but est déterminer le taux la répartition de l'IMC dans notre échantillonnage. Ainsi qu'essayer de déduire les causes pouvant influencer ces répartition de l'IMC.

# Matériel et méthodes utilisées

Nous avons utilisé Markdown et les données que tous les membres de la classe ont prélevé pour établir un tableau de données par la suite. Pour déterminer si un individu est en surpoids, on calcule l'IMC. C'est à dire "l'indicatif de masse corporel". Si notre individu a une IMC inférieur à 18.5, il est classé dans la catégorie "sous-poids", si une personne a un IMC entre 18.5 et en dessous de 25, elle se situe dans le groupe "normal", si un individu a un IMC égal ou supérieur à 25 et inférieur à 30 il est dans la catégorie "surpoids" et enfin les personnes ayant un indice dépaçant les 30, il est placé dans le groupe "obèse". 
L'IMC est un calcul fortement utilsé par le milieu médical pour déterminer dans quel groupe se situé l'individu et permettre d'agir en conséquence. 
Pour calculer l'IMC, il faut mesurer la masse(en kg) et la diviser par la taille (en mètre) au carré.

Le poids et la taille ( donc l'IMC) peut être influencer par toute une multitude de facteurs. Dans notre échantillonnage nous avons essaye de prendre en compte tout ces facteurs pouvant influencer l'IMC. Comme par exemple les habitudes alimentaires, les activités sportives,...

Dictionnaire de méthadonnées :

https://docs.google.com/document/d/1lgYD39W7vmVYyS5ea0wEl9ArE1dhuDRkIIBzZ4K6d_o/edit


# Résultats
## Importation des données et des outils nécessaires

```{r}
SciViews::R

# ! SI UNE COPIE LOCALE N'A PAS ENCORE ETE TELECHARGEE IL EST ESSENTIEL D'AVANT TOUT RUN TOUT LE R SCRIPT NOMME : DATA IMPORTATION.R !

biometry <- read("../data/biometry.rds")

head(biometry)
 
library(tidyverse)
library(plotly)
library(ggplot2)
library(ggExtra)
data(mpg, package="ggplot2")
library(ggridges)

```


## Tableau comparatif:

### Moyenne du poids et moyenne de taille 

```{r}

filter (biometry, taille>0, masse >0 , )%>.%

  summarise(. ,
  "moyenne taille" = mean(taille), 
  "moyenne masse" = mean(masse)) %>.%

  knitr::kable(., digits = 2)

```
## Répartition de l' IMC

 On peut se demander si dans notre population on a autant de personne pour lequels l'IMC est dit : obeses , surpoids , souspoids et pour finir normal.
 
### Visualisations
```{r}


chart(data = biometry, ~ IMC_RAP %fill=%IMC_RAP) +
  geom_bar(width = 1) +
  scale_fill_viridis_d()
```

#### Analyse


Le pourcentage le plus important est celui de la catégorie "normal". On a ensuite les "surpoids" puis les "obèses" pour terminer par les "sous-poids". La partie la plus faible de la population est le groupe des "sous-poids". Ces pourcentages correspondent bien à la zone d'échantillonage en effet la majorité des individus sont situé dans des régions développés, avec des ressources alimentaires suffisantes.

```{r}


a <- chart(biometry, ~ IMC_RAP) +
  geom_bar() + coord_flip()



b <-chart(biometry, ~ age_rec %fill=% age_rec) +
  geom_bar() + coord_flip()

c <- biometry %>.%
  filter(., IMC_RAP == "normal" ) %>.%
  chart(., ~ age_rec %fill=% age_rec) +
  geom_bar() + coord_flip()

combine_charts(list (a,b,c))



```

```{r}
group_by(biometry, age_rec , IMC_RAP)%>.%
summarise (., n = n() )%>.%
spread(., key = "IMC_RAP" , value="n")%>.%

head(.)
```

###Analyses

les graphiques semblent clair on voit bien que les classes ne sont pas uniformement répartie dans la population avec une prédominance des individus "normaux".Ceci est encore plus appuyé par le test suivant:





### Test chi carré

voici nos 2 hypothèses:

H0 :La répartition des 4 groupes d'IMC dans la population est égales.

H1 : La répartition diffère

```{r}
biometry %>.%
group_by(.,IMC_RAP)%>.%
summarise (., n = n() )%>.%
spread(., key = "IMC_RAP" , value="n")-> biometry_chi


biometry_chi
```



```{r}
chisq.test(biometry_chi, p = c(1/4, 1/4,1/4,1/4), rescale.p = FALSE)
```


### Analyses


Ici le test Chi Carré nous indique un p-value extremement faible de 2.2e-16  la différence est donc très significative 

### Discussion du test chi carré

Nos groupes d'IMC ne sont pas répartri équitablement dans la population on observe par exemple beaucoup plus d'individus "normaux " et les individus qualifié de " souspoids"sont en très faible effectif.


## Différence entre les individus 

### Les différences liées au genre

#### Répartition de la masse en fonction du genre

Est ce que la masse corrigée des personnes est identique dans la population selon le genre ou es ce que l'un des genres est en moyenne plus lourd que l autre ?:

observons ceci tout d'abord par une représentation graphique pour avoir une idée.


##### Graphique
```{r}
biometry<-filter(biometry, genre !="NA")

give_n <- function(x)
  c(y = max(x) * 1.1, label = length(x)) 

chart(data = biometry, masse_corr ~ genre %fill=% genre) +
  geom_boxplot(na.rm = TRUE) + stat_summary(fun.data = give_n, geom = "text", hjust = 0.5)
```

###### Analyse

Sur le graphique, il semble que les hommes (sex == "h") tendent à avoir une masse corrigée plus grande (variable masse-corr) que les femmes (sex == "f"), mais cette différence est-elle significative ou peut-elle être juste liée au hasard de l’échantillonnage ? Pour y répondre, nous devons élaborer un test de student qui va confronter les hypothèses suivantes (en se basant sur les moyennes) :

##### Test de student

voici nos 2 hypothèses :

H0:la différence des moyennes entre mesures pour les femmes et pour les hommes= 0

H1:la différence des moyennes entre mesures pour les femmes et pour les hommes≠ 0



test de student :

```{r}
t.test(data = biometry, masse_corr ~ genre,
  alternative = "two.sided", conf.level = 0.95, var.equal = TRUE)
```
##### Analyses 


Prenons une valeur de α de 5% , (α = 0.05).On compare notre valeur de α avec notre valeur de p qui est de: p-value=5.601e-09.

comme p <<<< α on rejette Ho qui se situe dans la zone de rejet.

##### Representation graphique des distributions:


```{r}
filter(biometry, genre !="NA",masse_corr !="NA")

biometry %>.%
group_by(.,genre) %>.%
summarise(.,"moyenne" = mean(masse_corr),
"ecart_type" = sd(masse_corr))



```

```{r}
sd(biometry$masse_corr)
(65.2120 + 78.3392)/2#moyenne des moyennes
```

```{r}
.mu <-0;.s <-1 ; .mu +.s *qt(0.025, df = 248, lower.tail = FALSE)
.mu <-0;.s <-1 ; .mu +.s *qt(0.025, df = 248, lower.tail = TRUE)
.mu <-0;.s <-1 ; .mu +.s *qt(5.601e-09
, df = 248, lower.tail = TRUE)
```


```{r}
# Student's t distribution (density probability) with parameters:
.mu <- 0; .s <- 1; .df <- 248 # .mu, .s (sigma) and .df
.col <- 1; .add <- FALSE # Plot parameters
.x <- seq(-4.5*.s+.mu, 4.5*.s+.mu, l = 1000)     # Quantiles
.d <- function (x) dt((x-.mu)/.s, df = .df)/.s   # Distribution function
.q <- function (p) qt(p, df = .df) * .s + .mu    # Quantile for lower-tail prob
.label <- bquote(t(.(.mu), .(.s), .(.df)))       # Parameters
curve(.d(x), xlim = c(-10,7), xaxs = "i", n = 1000, col = .col,
  add = .add, xlab = "Quantiles", ylab = "Probability density" ) # Curve
abline(h = 0, col = "gray") # Baseline
abline(v = -1.96, col = "red")
abline(v = 1.96, col = "red")
abline(v = -5.91, col = "green")
```

le quantile correspondant à l'hypothèse H0 (ligne verte)est situé dans la zone de rejet ( a gauche du quantile α(verticale rouge)) on rejette donc l'hypothèse H0.






##### Discussion du test de student

On en conclu donc que l hypothèse H1 est correcte et que la moyenne de la masse corrigée dans notre population sera significativement plus importante chez les hommes que chez les femmes.





#### Répartition de la taille en fonction du genre

On peut maintenant se demander si la taille des personnes est identique dans la population selon le genre ou es ce que l'un des genres est en moyenne plus grand que l autre ?:

##### Visualisations :


```{r}

filter (biometry, taille>0, masse >0 , ) %>.%
group_by(., genre)%>.%
summarise(.,
  "moyenne taille" = mean(taille), 
  "moyenne masse" = mean(masse))%>.%
knitr::kable(., digits = 2)
```

```{r}
chart(data= biometry, taille ~ masse %col=%genre) +
  geom_point()
```

##### Analyses:

Les femmes sont en moyenne plus petites que les hommes et ont logiquement un masse plus petite que les hommes.

```{r}
biometry<-filter(biometry, genre !="NA")

give_n <- function(x)
  c(y = max(x) * 1.1, label = length(x)) 

chart(data = biometry, taille ~ genre %fill=% genre) +
  geom_boxplot(na.rm = TRUE) + stat_summary(fun.data = give_n, geom = "text", hjust = 0.5)

```

##### Analyses:

Sur le graphique, il semble que les hommes (sex == "h") tendent à avoir une taille plus grande (variable taille) que les femmes (sex == "f"), mais cette différence est-elle significative ou peut-elle être juste liée au hasard de l’échantillonnage ? Pour y répondre, nous devons élaborer un Test de Wilcoxon-Mahn-Withney qui va confronter les hypothèses suivantes (en se basant sur les médianes) :

##### Test de Wilcoxon

Dans le test de student nous avons supposé que la distribution de départ était de type normal.Or lorsqu'on a un faible échantillonage on peut douter que la distribution suis bien une loi normale on va donc utiliser un autre test celui de Test de Wilcoxon-Mahn-Withney une version non-paramétrique du test de student.

voici nos 2 hypothèses:

H0:P(taillef>tailleh)=P(taillef<tailleh)
H1:P(taillef>tailleh)≠P(taillef<tailleh)

```{r}
wilcox.test(data = biometry, taille ~ genre,
  alternative = "less", conf.level = 0.95)
```

##### Analyses 

Prenons une valeur de α de 5% , (α = 0.05).On compare notre valeur de α avec notre valeur de p qui est de: p-value=2.2e-16.

comme p <<<< α on rejette Ho qui se situe dans la zone de rejet.


##### Discussion du test de wilcoxon

On en conclu donc que l hypothèse H1 est correcte et que la moyenne de la taille dans notre population sera significativement plus importante chez les hommes que chez les femmes.

#### Répartition de l'IMC en fonction du genre

```{r}
chart(data = biometry, ~IMC_RAP %fill=% genre ) +
  geom_bar(position = "dodge")
```

##### Analyse


Lorsqu'on compare les hommes et les femmes, on remarque que le pourcentage de femmes est plus importante pour la catégorie "normal" et "souspoid". Et le pourcentage d'homme est plus important pour le "surpoid" et "obese".On peut donc constater que les hommes ont un pourcentage de "surpoids" et "obese" plus important que les femmes.

#### Répartition du tour de poignet en fonction du genre 

```{r}
filter (biometry, tour_poignet >0 )%>.%
group_by(., genre)%>.%
summarise(.,
  "moyenne tour de poignet" = mean(tour_poignet))%>.%
head(.)
```
il y a une différence mais bon savoir si cette différence entre homme et femme a comme lien avec l'imc je suis pas convaincu.

### Les différences lié à l'âge

```{r}

group_by(biometry, age_rec)%>.%

summarise(.,
  "moyenne taille" = mean(taille), 
  "moyenne masse" = mean(masse))%>.%

head(.)
```

#### Analyse


On remarque sur ces moyennes que les personnes agés sont en moyenne plus petit mais elles ont un poids un peu près identique a celui des adultes. Les jeunes adultes ont une taille un peu près identique à celle des adultes cependant leur moyenne pour le poids est plus faible. Cela s'explique par le faite que les jeunes viennent de terminer leur croissance et le corps utilse des ressources pour grandir. Par la suite le corps adulte se nourrit pour survivre, il n'avait plus besoin de nourriture supplémentaire pour sa croissance.

#### Etude de la masse en fonction ds catégories d'age.

Imaginons que nous voulons comparer la masse corrigée des individus en fonction de leur age (on formera une variable facteur en formant des groupes d'ages(plus de deux)).


##### Graphiques et visualisations

```{r}
biometry %>.%
  group_by(., age_rec) %>.%
  filter(.,age_rec !="NA",masse_corr !="NA")%>.%
  summarise(., mean = mean(masse_corr), sd = sd(masse_corr), count = sum(!is.na(masse_corr)))
```

```{r}
biometry %>.%
  group_by(., age_rec) %>.%
  filter(.,age_rec !="NA")%>.%
  chart(data = .,masse_corr ~ age_rec) + # Je réalise un graphique 
  geom_violin() + # Je réalise un graphique en violon
  geom_jitter(width = 0.05, alpha = 0.5) + # J'ajoute les points sur le graphique 
  stat_summary(geom = "point", fun.y = "mean", color = "green", size = 4) # J'ajoute la moyenne en vert
```

##### Analyses

On semble voir une différence entre les différentes classes mais cette différence est t'elle significatice ou pas ? pour le savoir on va réaliser  un test de Kruskal-Wallis ou utiliser le modèle de l'ANOVA:

##### ANOVA ou Kruskal-Wallis ?

Nous pourions comparer chaque groupe l'un avec l'autre c'est long et nous ne le ferons pas car à chaque test nous prenons un risque de nous tromper. Le risque de se tromper au moins une fois dans l’ensemble des tests est alors décuplé en cas de tests multiples.

On ne peut plus utiliser le test de student ou de wilcoxon car un compare plus de deux population ! On va donc utiliser le test de Kruskal-Wallis ou le modèle de l'ANOVA:

test anova:

on a maintenant prit connaissance de nos données on va se demander si il y a homoscédasticité des variances via un test de Barlett:

dont les hypothèses sont:

H0:var1=var2=...=vark     (homoscédasticité)
H1:∃(i,j) tel que vari≠varj       (hétéroscédasticité)

```{r}

biometry %>.%
  group_by(., age_rec) %>.%
  filter(.,age_rec !="NA",masse_corr!="NA")%>.%
bartlett.test(data = .,masse_corr ~ age_rec)
```

ici la p-value est plus petite qu'alpha (0.05) ont rejette donc H0, on a besoin que H0 soit non rejettée pour utiliser le modèle de l'ANOVA sinon on se rabattra sur un test de Kruskal-Wallis:

```{r}

biometry %>.%
  group_by(., age_rec) %>.%
  filter(.,age_rec !="NA",masse_corr!="NA")%>.%
bartlett.test(data = .,log(masse_corr) ~ age_rec)
```

ici la p-value est suppérieur a alpha(0.05) on peut donc utiliser l'ANOVA avec log(masse-corr)

##### Visualisation de la nouvelle variable:

```{r}
biometry %>.%
  group_by(., age_rec) %>.%
  filter(.,age_rec !="NA",masse_corr !="NA")%>.%
  summarise(., mean = mean(log(masse_corr)), sd = sd(log(masse_corr)), count = sum(!is.na(log(masse_corr))))
```

```{r}
biometry %>.%
  group_by(., age_rec) %>.%
  filter(.,age_rec !="NA")%>.%

chart(data = .,log(masse_corr) ~ age_rec) + # Je réalise un graphique 
  geom_violin() + # Je réalise un graphique en violon
  geom_jitter(width = 0.05, alpha = 0.5) + # J'ajoute les points sur le graphique 
  stat_summary(geom = "point", fun.y = "mean", color = "green", size = 4) # J'ajoute la moyenne en vert
```

avant de continuer on dois vérifier si la distibution est bien de type normale pour pouvoir utiliser l'ANOVA :

```{r}


anova(anova. <- lm(data = biometry, masse_corr ~ age_rec))

#plot(anova., which = 2)
anova. %>.%
  chart(broom::augment(.), aes(sample = .std.resid)) +
  geom_qq() +
  #geom_qq_line(colour = "darkgray") +
  labs(x = "Theoretical quantiles", y = "Standardized residuals") +
  ggtitle("Normal Q-Q")
```

##### Analyse



on observe que la distribution est non normale pour les valeurs plus importante on prèferera donc utiliser le modèle non paramétrique du test de Kruskal-Wallis.

##### Test de Kruskal-Wallis

Dans le test de Kruskal-Wallis, sous H0 nous avons le même rang moyen (noté mr) pour chaque groupe parmi k. Sous H1, au moins deux groupes ont des rangs moyens différents:

H0:mr1=mr2=...=mrk

H1:∃(i,j) tel que mri≠mrj

```{r}
kruskal.test(data = biometry, masse_corr ~ age_rec)
```

##### Analyses

comme p-value est bien plus petit qu'aplha (0.05) on rejette H0 et on peut dire qu'il existe au moins une différence significative entre les ratios .

##### Test post hoc

on a déterminer une différencee significative mais est t'elle présente entre tout les groupes ou seulement entre certain ? on réalise un test post hoc pour le savoir(test de tukey):

```{r}
summary(kw_comp. <- nparcomp::nparcomp(data = biometry, masse_corr ~ age_rec))
```

```{r}
plot(kw_comp.)
```

##### Discussion du test de Kruskal 

Ici, toutes les différences sont considérées comme significatives sauf  la comparaison des [20-50]-[50-100] avec une valeur P tout juste non significative de 6.833583e-02 mais à prendre avec des pincettes étant donné sa proximité du seuil.


#### Etude de la relation masse <-> taille en fonction de la catégorie d'âge.

```{r}
chart(data= biometry, taille ~ masse %col=% age_rec) +
  geom_point()+ geom_smooth(se= FALSE)
```

##### Analyse

Sur le graphique, ce graphique est trés interessant car grâce à lui on constate que la taille et le poids varie bien en fonction de l'âge. Pour les personnes agés on constate une incohérence dans la ligne tracé. La raison pourrait être celle du faite que notre échantillonnage comporte peu de personnes agés.

#### Répartition de l'IMC  en fonction des catégories d'age.

```{r}
chart(data = biometry, ~IMC_RAP %fill=% age_rec ) +
  geom_bar(position = "dodge") + coord_flip()
```

##### Analyse




Ce graphique est intéressant. Grace à ce graphe, on remarque que notre échantillonage aléatoire n'est pas parfait en effet il y a une grande quantité de jeune individus et très peu d'individus agés.Il y a même aucun individu agés dans la catégorie sous-poids. 
Mais si on passe au dessus des erreurs d'échantillonnage les valeurs sont intéressant. Le quantité de jeune en sous-poids et environ égal à celle du surpoids. Pour les sujets adutles c'est une tout autre histoire, il y a presqu'aucun pour les sous-poids et ils sont beaucoup plus nombreux pour les surpoids. En conclusion, ce graphique nous conforte dans nos affrimations dites plus haut: Plus les individus vieillissent plus leur IMC grandit.

```{r}


chart(biometry, ~ age_rec %fill=% age_rec) +
  geom_bar() + coord_flip()

biometry %>.%
  filter(., IMC_RAP == "normal" ) %>.%
  chart(., ~ age_rec %fill=% age_rec) +
  geom_bar() + coord_flip()





```

```{r}
group_by(biometry, age_rec , IMC_RAP)%>.%
summarise (., n = n() )%>.%
spread(., key = "IMC_RAP" , value="n")%>.%

head(.)
```

##### Analyse

## Causes pouvant influencer l'IMC de nos individus.



### Alcool

```{r}
biometry_alcoolA <-  filter (biometry,IMC_RAP == "souspoid"  )
biometry_alcoolA <- summarise (biometry_alcoolA, " souspoid" = mean(alcool))

biometry_alcoolB <-  filter (biometry,IMC_RAP == "obese"  )
biometry_alcoolB <- filter (biometry_alcoolB, alcool != "NA")

biometry_alcoolB <- summarise (biometry_alcoolB, " obèses" = mean(alcool))

biometry_alcoolC <-  filter (biometry,IMC_RAP == "surpoid"  )
biometry_alcoolC <- filter (biometry_alcoolC, alcool != "NA")
biometry_alcoolC <- summarise (biometry_alcoolC, "surpoid" = mean(alcool))

biometry_alcoolD <-  filter (biometry,IMC_RAP == "normal"  )
biometry_alcoolD <- filter (biometry_alcoolD, alcool != "NA")

biometry_alcoolD <- summarise (biometry_alcoolD, "normaux" = mean(alcool))

biometry_alcool <- bind_cols( biometry_alcoolA, biometry_alcoolD, biometry_alcoolC, biometry_alcoolB)
knitr::kable(biometry_alcool, digits = 2)

```

#### Analyse



On constate que la moyenne d'alcool pour les différents groupes ("souspoids", "normal", "surpoids","obèse") augmente en même temps que le IMC , on peut donc faire une corrélation entre les 2 variables. Ce lien constiste à dire que la consommation d'alcool entraine l'augmentation de l'IMC cependant il faut prendre ces résultats avec précautions car nous avons des valeurs extrèmes qui faussent notre moyenne est l'écart des valeurs réelles de la majorité de la population. 

```{r}
p=ggplot(biometry, aes(x= alcool, y= IMC , color= IMC_RAP, shape= genre)) + 
    geom_point(size=1, alpha=0.6)

ggplotly(p)
```

```{r}

chart(data = biometry, ~ alcool %fill=% IMC_RAP | IMC_RAP) +
  geom_histogram(data = select(biometry, -IMC_RAP), fill = "grey", bins = 25) + 
  geom_histogram(show.legend = FALSE, bins = 25, na.rm = FALSE) +
  ylab("Effectifs") +
  scale_fill_viridis_d()
chart(data = biometry, alcool ~ IMC_RAP %fill=% IMC_RAP) + geom_boxplot(show.legend = FALSE)

```

#### Analyse


Les graphiques nous confirment nos premières analyses . Les individus en sous-poids prennent moins d'alcool que les individus en surpoids.
On peut également mettre en lien, l'age et l'alcool car on a constaté plus tôt que les individus jeunes sont en général plus en sous-poids que les adultes et les personnes agés. Dans notre catégorie de jeune, il y a des personnes ayant un age inférieur à 16 ans qui est la limite d'autorisation pour l'alcool, les individus plus agé sont plus confronté à l'alcool que les jeunes.
Attention cependant, beaucoup d'autres facteurs peut interférer.

### Grignotage

```{r}
biometry_grignotageA <-  filter (biometry2,IMC_RAP == "souspoid"  )
biometry_grignotageA <- filter (biometry_grignotageA, grignotage != "NA")
biometry_summaryA3 <- summarise (biometry_grignotageA, "moyenne de consommation de grignotage" = mean(grignotage))
knitr::kable(biometry_summaryA3, digits = 2)

biometry_grignotageB <-  filter (biometry2,IMC_RAP == "obese"  )
biometry_grignotageB <- filter (biometry_grignotageB, grignotage != "NA")
biometry_summaryB3 <- summarise (biometry_grignotageB, "moyenne de consommation de grignotage" = mean(grignotage))
knitr::kable(biometry_summaryB3, digits = 2)

biometry_grignotageC <-  filter (biometry2,IMC_RAP == "surpoid"  )
biometry_grignotageC <- filter (biometry_grignotageC, grignotage != "NA")
biometry_summaryC3 <- summarise (biometry_grignotageC, "moyenne de consommation de grignotage" = mean(grignotage))
knitr::kable(biometry_summaryC3, digits = 2)

biometry_grignotageD <-  filter (biometry2,IMC_RAP == "normal"  )
biometry_grignotageD <- filter (biometry_grignotageD, grignotage != "NA")
biometry_summaryD3 <- summarise (biometry_grignotageD, "moyenne de consommation de grignotage" = mean(grignotage))
knitr::kable(biometry_summaryD3, digits = 2)
```


#### Analyse


Pour les moyennes du grignotage, le groupe du "souspoids" à la moyenne la plus forte est le groupe "obèse" possède la moyenne la plus faible. Ces résultats sont très intéressant on peut voir un lien entre l'IMC et le grignotage.En moyenne les personnes grignotant beaucoup ont un poids plus faible.Cependant les différences entre les moyennes sont relativement faible et il faut faire attention aux valeurs extrèmes qui peuvent influencé la moyenne. Il faut prendre ces résultats avec des pincettes car nous avons pas déterminer le type de grignotage : fruits ou friandises.

```{r}
p=ggplot(biometry2, aes(x= grignotage, y= IMC , color= IMC_RAP, shape= genre)) + 
    geom_point(size=1, alpha=0.6)

ggplotly(p)
```
```{r}
nbins <- 25
chart(data = biometry2, ~ grignotage %fill=% IMC_RAP | IMC_RAP) +
  geom_histogram(data = select(biometry2, -IMC_RAP), fill = "grey", bins = nbins) + 
  geom_histogram(show.legend = FALSE, bins = nbins, na.rm = FALSE) +
  ylab("Effectifs") +
  scale_fill_viridis_d()
```


```{r}
give_n <- function(x)
  c(y = max(x) * 1.1, label = length(x)) 
chart(data = biometry2, grignotage ~ IMC_RAP %fill=% IMC_RAP) + geom_boxplot(show.legend = FALSE)+ stat_summary(fun.data = give_n, geom = "text", hjust = 0.5)

```

#### Analyses

Sur les graphiques, on constate qu'il n'y a pas de différences significatives entre les individus
Les moyennes étaient légèrement différentes à cause des valeurs extrèmes. 

### Protéine animale

```{r}
biometry_PA <-  filter (biometry2,IMC_RAP == "souspoid"  )
biometry_PA <- filter (biometry_PA, proteine_animale != "NA")
biometry_summaryA4 <- summarise (biometry_PA, "moyenne de consommation de proteine animale" = mean(proteine_animale))
knitr::kable(biometry_summaryA4, digits = 2)

biometry_PB <-  filter (biometry2,IMC_RAP == "obese"  )
biometry_PB <- filter (biometry_PB, proteine_animale != "NA")
biometry_summaryB4 <- summarise (biometry_PB, "moyenne de consommation de proteine animale" = mean(proteine_animale))
knitr::kable(biometry_summaryB4, digits = 2)

biometry_PC <-  filter (biometry2,IMC_RAP == "surpoid"  )
biometry_PC <- filter (biometry_PC, proteine_animale != "NA")
biometry_summaryC4 <- summarise (biometry_PC, "moyenne de consommation de proteine animale" = mean(proteine_animale))
knitr::kable(biometry_summaryC4, digits = 2)

biometry_PD <-  filter (biometry2,IMC_RAP == "normal"  )
biometry_PD <- filter (biometry_PD, proteine_animale != "NA")
biometry_summaryD4 <- summarise (biometry_PD, "moyenne de consommation de proteine animale" = mean(proteine_animale))
knitr::kable(biometry_summaryD4, digits = 2)
```

#### Analyse

Le groupe des "souspoids" possède la moyenne la plus faible et le groupe"obèse" possède la moyenne la plus grande. On peut conclure que les protéines animales ont une influence avec la prise de poids. Pour la catégorie "normal"et"surpoids"les valeurs sont assez proche. Il doit y avoir un autre facteur qui doit influencé l'IMC.

```{r}
nbins <- 25
chart(data = biometry2, ~ proteine_animale %fill=% IMC_RAP | IMC_RAP) +
  geom_histogram(data = select(biometry2, -IMC_RAP), fill = "grey", bins = nbins) + 
  geom_histogram(show.legend = FALSE, bins = nbins, na.rm = FALSE) +
  ylab("Effectifs") +
  scale_fill_viridis_d()

```


```{r}
give_n <- function(x)
  c(y = max(x) * 1.1, label = length(x)) 
chart(data = biometry2, proteine_animale ~ IMC_RAP %fill=% IMC_RAP) + geom_boxplot(show.legend = FALSE)+ stat_summary(fun.data = give_n, geom = "text", hjust = 0.5)

```

#### Analyses

Le graphique nous révèle que les personnes en sous-poids prennent une quantité moins importante de viande. Pour le groupe "obèse", ce sont les valeurs extrèmes qui ont influencé la moyenne. Le manque de protéine animal entraine le sous-poids. Mais la surconsommation de protéine animal ne nous indique pas clairement qu'il entraine une augmentation de l'IMC.

### Fastfood

```{r}
biometry_fastfoodA <-  filter (biometry2,IMC_RAP == "souspoid"  )
biometry_fasfoodA <- filter (biometry_fastfoodA, fastfood != "NA")
biometry_summaryA2 <- summarise (biometry_fastfoodA, "moyenne de consommation de fastfood" = mean(fastfood))
knitr::kable(biometry_summaryA2, digits = 2)

biometry_fastfoodB <-  filter (biometry2, IMC_RAP == "obese"  )
biometry_fastfoodB <- filter (biometry_fastfoodB, fastfood != "NA")
biometry_summaryB2 <- summarise (biometry_fastfoodB, "moyenne de consommation de fastfood" = mean(fastfood))
knitr::kable(biometry_summaryB2, digits = 2)

biometry_fastfoodC <-  filter (biometry2,IMC_RAP == "surpoid"  )
biometry_fastfoodC <- filter (biometry_fastfoodC, fastfood != "NA")
biometry_summaryC2 <- summarise (biometry_fastfoodC, "moyenne de consommation de fastfood" = mean(fastfood))
knitr::kable(biometry_summaryC2, digits = 2)

biometry_fastfoodD <-  filter (biometry2,IMC_RAP == "normal"  )
biometry_fastfoodD <- filter (biometry_fastfoodD, fastfood != "NA")

biometry_summaryD2 <- summarise (biometry_fastfoodD, "moyenne de consommation de fastfood" = mean(fastfood))
knitr::kable(biometry_summaryD2, digits = 2)

```

#### Analyses

Ici les moyennes donnent des conclusions moins significatives. On remarque que la moyenne la plus faible est attribuée à la catégorie du "souspoids", cependant la moyenne la plus forte est celle du groupe normal.Dans les groupes "souspoids","surpoids" et "obèse" on a une augmentation lié à la montée du IMC. Le groupe"normal" ne suit pas notre hypothèse, les différentes raisons sont que soit les fastfood n'ont pas de lien avec la prise de point ou soit nous avons oublié de tenir compte d'une autre variable pouvant influencer sur l'IMC ( 2 hypothèse est la bonne car la catégorie "normale" est le groupe fesant le plus de sport , il faut faire donc tout suite après un graphique sur le sport )

```{r}
nbins <- 25
chart(data = biometry2, ~ fastfood %fill=% IMC_RAP | IMC_RAP) +
  geom_histogram(data = select(biometry2, -IMC_RAP), fill = "grey", bins = nbins) + 
  geom_histogram(show.legend = FALSE, bins = nbins, na.rm = FALSE) +
  ylab("Effectifs") +
  scale_fill_viridis_d()

```


```{r}
give_n <- function(x)
  c(y = max(x) * 1.1, label = length(x)) 
chart(data = biometry2, fastfood ~ IMC_RAP %fill=% IMC_RAP) + geom_boxplot(show.legend = FALSE)+ stat_summary(fun.data = give_n, geom = "text", hjust = 0.5)

```

#### Analyses

On peut remarquer que le groupe sous-poids mange moins de fastfood.Le faite de manger plus souvent amène donc à un IMC plus important. Cependant pour les autres groupes il n'y a pas de différences significatives. Il doit y avoir un autre facteur qui influence les 3 groupes. Surtout pour le groupe normal qui en général mange environ une même quantité de fastfood que le groupe obèse. 



### Activités physique

```{r}
biometry_SA <-  filter (biometry2,IMC_RAP == "souspoid"  )
biometry_SA <- filter (biometry_SA, acti_physique != "NA")
biometry_SA <- summarise (biometry_SA, "souspoid" = mean(acti_physique))

biometry_SB <-  filter (biometry2,IMC_RAP == "obese"  )
biometry_SB <- filter (biometry_SB, acti_physique != "NA")
biometry_SB <- summarise (biometry_SB, "obèses" = mean(acti_physique))

biometry_SC <-  filter (biometry2,IMC_RAP == "surpoid"  )
biometry_SC <- filter (biometry_SC, acti_physique != "NA")
biometry_SC <- summarise (biometry_SC, "surpoid" = mean(acti_physique))

biometry_SD <-  filter (biometry2,IMC_RAP == "normal"  )
biometry_SD <- filter (biometry_SD, acti_physique != "NA")
biometry_SD <- summarise (biometry_SD, "normales" = mean(acti_physique))

biometry_S <- bind_cols( biometry_SA, biometry_SD, biometry_SC, biometry_SB)

knitr::kable(biometry_S, digits = 2)
```

####Analyses

Les individus fesant le plus de sport sont ceux avec l'IMC le plus faible. On peut en conclure que le sport diminue l'IMC des individus. Cependant on peut remarqué que le groupe fesant le plus de sport est le groupe normal et non le groupe sous-poids. 
La raison de cette variation inattendu sont les autres facteurs influençant l'IMC.Le groupe "normal" fait plus de sport mais il mange également plus de fastfood.  

```{r}
nbins <- 25
chart(data = biometry2, ~ acti_physique %fill=% IMC_RAP | IMC_RAP) +
  geom_histogram(data = select(biometry2, -IMC_RAP), fill = "grey", bins = nbins) + 
  geom_histogram(show.legend = FALSE, bins = nbins, na.rm = FALSE) +
  ylab("Effectifs") +
  scale_fill_viridis_d()

```

```{r}
give_n <- function(x)
  c(y = max(x) * 1.1, label = length(x)) 
chart(data = biometry2, acti_physique ~ IMC_RAP %fill=% IMC_RAP) + geom_boxplot(show.legend = FALSE)+ stat_summary(fun.data = give_n, geom = "text", hjust = 0.5)

```

#### Analyses

Les graphiques nous montrent bien que les 2 groupes les plus fins sont les groupes fesant le plus de sports. Le sport influence la diminution de l'IMC


### Activités professionnels

```{r}
a <- filter(biometry2, IMC_RAP == "souspoid")%>.%
  chart(., ~ factor(0) %fill=% acti_profession) +
  geom_bar(width = 1) + 
  coord_polar("y", start = 0) +
  theme_void() +
  scale_fill_viridis_d()

b <- filter(biometry2, IMC_RAP == "normal")%>.%
  chart(., ~ factor(0) %fill=% acti_profession) +
  geom_bar(width = 1) + 
  coord_polar("y", start = 0) +
  theme_void() +
  scale_fill_viridis_d()

c <- filter(biometry2, IMC_RAP == "surpoid")%>.%
  chart(., ~ factor(0) %fill=% acti_profession) +
  geom_bar(width = 1) + 
  coord_polar("y", start = 0) +
  theme_void() +
  scale_fill_viridis_d()

d <- filter(biometry2, IMC_RAP == "souspoid")%>.%
  chart(., ~ factor(0) %fill=% acti_profession) +
  geom_bar(width = 1) + 
  coord_polar("y", start = 0) +
  theme_void() +
  scale_fill_viridis_d()

combine_charts(list(a, b, c, d), common.legend = TRUE, labels = c("sous-poids", "normal", "surpoids", "obèse"))

```

#### Analyses

On ne peut pas tirer de conclusions pouvant influencer l'IMC, les autres facteurs mesurés semble avoir plus d'importance que l'activité professionel. Les raisons de se méfier des valeurs sont que les groupes obèse et le groupe sous-poids ont environ les mêmes proportions alors que l'IMC est très différents entre les 2. 
Les raisons de ces incohérences pourrez être dû aux autres valeurs, les individus ayant une vie sédentaire vont la compenser en fesant plus de sport.

# Discussion

# Conclusion




